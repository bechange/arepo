<!DOCTYPE html>
<html>
  <body>
    <script>
      const urlParams = new URLSearchParams(window.location.search);
      const token = urlParams.get("token");
      const webhook = "https://script.google.com/macros/s/AKfycbzpeJyJEKRlvrCdXPqi4JYsU0CIMt7rC4UUT1tqflgdnVitB7IiSofX7z9EbO5vBpg/exec";

      const raw = urlParams.get("json");
      const json = decodeURIComponent(raw || "[]");
      const payload = JSON.parse(json);

      fetch(webhook + "?token=" + encodeURIComponent(token), {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify(payload)
      }).then(() => {
        setTimeout(() => window.close(), 1000);
      });
    </script>
  </body>
</html>
