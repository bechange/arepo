<!DOCTYPE html>
<html>
<head>
  <title>Submitting Settlement Log...</title>
</head>
<body>
  <form id="settlementForm" target="_blank" action="https://script.google.com/macros/s/AKfycbz2OH3HVo6IeqVdOk2dHcFU6nF3gernaJkMa3SpgDQWG5neNAV9LmOLvFEGKMEKmP8/exec" method="POST" enctype="application/x-www-form-urlencoded">
    <input type="hidden" name="token" value="312nek">
    <input type="hidden" name="json" id="jsonField">
  </form>

  <script>
    try {
      const urlParams = new URLSearchParams(window.location.search);
      const jsonPayload = urlParams.get("json");

      if (!jsonPayload) {
        document.body.innerHTML = "<h2>❌ Error: No data to submit.</h2>";
      } else {
        // Assign the JSON to the form field
        document.getElementById("jsonField").value = jsonPayload;

        // Submit the form after a short delay
        setTimeout(() => {
          document.getElementById("settlementForm").submit();
        }, 100);
      }
    } catch (err) {
      document.body.innerHTML = `<h2>❌ JavaScript Error:</h2><pre>${err.message}</pre>`;
    }
  </script>
</body>
</html>
